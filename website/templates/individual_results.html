{% extends 'base.html' %}

{% block content %}
{% load static %}

{% include 'sidebar.html' %}

<div class="main">
    <nav class="navbar navbar-expand navbar-light navbar-bg">
                    <a class="sidebar-toggle js-sidebar-toggle">
                      <i class="hamburger align-self-center"></i>
                    </a>

<!--                    <div class="navbar-collapse collapse">-->
<!--                        <ul class="navbar-nav navbar-align">-->
<!--                            <li class="nav-item dropdown">-->
<!--                                <a class="nav-icon dropdown-toggle" href="#" id="alertsDropdown" data-bs-toggle="dropdown">-->
<!--                                    <div class="position-relative">-->
<!--                                        <i class="align-middle" data-feather="bell"></i>-->
<!--                                        <span class="indicator">4</span>-->
<!--                                    </div>-->
<!--                                </a>-->
<!--                                <div class="dropdown-menu dropdown-menu-lg dropdown-menu-end py-0" aria-labelledby="alertsDropdown">-->
<!--                                    <div class="dropdown-menu-header">-->
<!--                                        4 New Notifications-->
<!--                                    </div>-->
<!--                                    <div class="list-group">-->
<!--                                        <a href="#" class="list-group-item">-->
<!--                                            <div class="row g-0 align-items-center">-->
<!--                                                <div class="col-2">-->
<!--                                                    <i class="text-danger" data-feather="alert-circle"></i>-->
<!--                                                </div>-->
<!--                                                <div class="col-10">-->
<!--                                                    <div class="text-dark">Update completed</div>-->
<!--                                                    <div class="text-muted small mt-1">Restart server 12 to complete the update.</div>-->
<!--                                                    <div class="text-muted small mt-1">30m ago</div>-->
<!--                                                </div>-->
<!--                                            </div>-->
<!--                                        </a>-->
<!--                                        <a href="#" class="list-group-item">-->
<!--                                            <div class="row g-0 align-items-center">-->
<!--                                                <div class="col-2">-->
<!--                                                    <i class="text-warning" data-feather="bell"></i>-->
<!--                                                </div>-->
<!--                                                <div class="col-10">-->
<!--                                                    <div class="text-dark">Lorem ipsum</div>-->
<!--                                                    <div class="text-muted small mt-1">Aliquam ex eros, imperdiet vulputate hendrerit et.</div>-->
<!--                                                    <div class="text-muted small mt-1">2h ago</div>-->
<!--                                                </div>-->
<!--                                            </div>-->
<!--                                        </a>-->
<!--                                        <a href="#" class="list-group-item">-->
<!--                                            <div class="row g-0 align-items-center">-->
<!--                                                <div class="col-2">-->
<!--                                                    <i class="text-primary" data-feather="home"></i>-->
<!--                                                </div>-->
<!--                                                <div class="col-10">-->
<!--                                                    <div class="text-dark">Login from 192.186.1.8</div>-->
<!--                                                    <div class="text-muted small mt-1">5h ago</div>-->
<!--                                                </div>-->
<!--                                            </div>-->
<!--                                        </a>-->
<!--                                        <a href="#" class="list-group-item">-->
<!--                                            <div class="row g-0 align-items-center">-->
<!--                                                <div class="col-2">-->
<!--                                                    <i class="text-success" data-feather="user-plus"></i>-->
<!--                                                </div>-->
<!--                                                <div class="col-10">-->
<!--                                                    <div class="text-dark">New connection</div>-->
<!--                                                    <div class="text-muted small mt-1">Christina accepted your request.</div>-->
<!--                                                    <div class="text-muted small mt-1">14h ago</div>-->
<!--                                                </div>-->
<!--                                            </div>-->
<!--                                        </a>-->
<!--                                    </div>-->
<!--                                    <div class="dropdown-menu-footer">-->
<!--                                        <a href="#" class="text-muted">Show all notifications</a>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </li>-->
<!--                            <li class="nav-item dropdown">-->
<!--                                <a class="nav-icon dropdown-toggle" href="#" id="messagesDropdown" data-bs-toggle="dropdown">-->
<!--                                    <div class="position-relative">-->
<!--                                        <i class="align-middle" data-feather="message-square"></i>-->
<!--                                    </div>-->
<!--                                </a>-->
<!--                                <div class="dropdown-menu dropdown-menu-lg dropdown-menu-end py-0" aria-labelledby="messagesDropdown">-->
<!--                                    <div class="dropdown-menu-header">-->
<!--                                        <div class="position-relative">-->
<!--                                            4 New Messages-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                    <div class="list-group">-->
<!--                                        <a href="#" class="list-group-item">-->
<!--                                            <div class="row g-0 align-items-center">-->
<!--                                                <div class="col-2">-->
<!--                                                    <img src="img/avatars/avatar-5.jpg" class="avatar img-fluid rounded-circle" alt="Vanessa Tucker">-->
<!--                                                </div>-->
<!--                                                <div class="col-10 ps-2">-->
<!--                                                    <div class="text-dark">Vanessa Tucker</div>-->
<!--                                                    <div class="text-muted small mt-1">Nam pretium turpis et arcu. Duis arcu tortor.</div>-->
<!--                                                    <div class="text-muted small mt-1">15m ago</div>-->
<!--                                                </div>-->
<!--                                            </div>-->
<!--                                        </a>-->
<!--                                        <a href="#" class="list-group-item">-->
<!--                                            <div class="row g-0 align-items-center">-->
<!--                                                <div class="col-2">-->
<!--                                                    <img src="img/avatars/avatar-2.jpg" class="avatar img-fluid rounded-circle" alt="William Harris">-->
<!--                                                </div>-->
<!--                                                <div class="col-10 ps-2">-->
<!--                                                    <div class="text-dark">William Harris</div>-->
<!--                                                    <div class="text-muted small mt-1">Curabitur ligula sapien euismod vitae.</div>-->
<!--                                                    <div class="text-muted small mt-1">2h ago</div>-->
<!--                                                </div>-->
<!--                                            </div>-->
<!--                                        </a>-->
<!--                                        <a href="#" class="list-group-item">-->
<!--                                            <div class="row g-0 align-items-center">-->
<!--                                                <div class="col-2">-->
<!--                                                    <img src="img/avatars/avatar-4.jpg" class="avatar img-fluid rounded-circle" alt="Christina Mason">-->
<!--                                                </div>-->
<!--                                                <div class="col-10 ps-2">-->
<!--                                                    <div class="text-dark">Christina Mason</div>-->
<!--                                                    <div class="text-muted small mt-1">Pellentesque auctor neque nec urna.</div>-->
<!--                                                    <div class="text-muted small mt-1">4h ago</div>-->
<!--                                                </div>-->
<!--                                            </div>-->
<!--                                        </a>-->
<!--                                        <a href="#" class="list-group-item">-->
<!--                                            <div class="row g-0 align-items-center">-->
<!--                                                <div class="col-2">-->
<!--                                                    <img src="img/avatars/avatar-3.jpg" class="avatar img-fluid rounded-circle" alt="Sharon Lessman">-->
<!--                                                </div>-->
<!--                                                <div class="col-10 ps-2">-->
<!--                                                    <div class="text-dark">Sharon Lessman</div>-->
<!--                                                    <div class="text-muted small mt-1">Aenean tellus metus, bibendum sed, posuere ac, mattis non.</div>-->
<!--                                                    <div class="text-muted small mt-1">5h ago</div>-->
<!--                                                </div>-->
<!--                                            </div>-->
<!--                                        </a>-->
<!--                                    </div>-->
<!--                                    <div class="dropdown-menu-footer">-->
<!--                                        <a href="#" class="text-muted">Show all messages</a>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </li>-->
<!--                            <li class="nav-item dropdown">-->
<!--                                <a class="nav-icon dropdown-toggle d-inline-block d-sm-none" href="#" data-bs-toggle="dropdown">-->
<!--                    <i class="align-middle" data-feather="settings"></i>-->
<!--                  </a>-->

<!--                                <a class="nav-link dropdown-toggle d-none d-sm-inline-block" href="#" data-bs-toggle="dropdown">-->
<!--                    <img src="img/avatars/avatar.jpg" class="avatar img-fluid rounded me-1" alt="Charles Hall" /> <span class="text-dark">Charles Hall</span>-->
<!--                  </a>-->
<!--                                <div class="dropdown-menu dropdown-menu-end">-->
<!--                                    <a class="dropdown-item" href="pages-profile.html"><i class="align-middle me-1" data-feather="user"></i> Profile</a>-->
<!--                                    <a class="dropdown-item" href="#"><i class="align-middle me-1" data-feather="pie-chart"></i> Analytics</a>-->
<!--                                    <div class="dropdown-divider"></div>-->
<!--                                    <a class="dropdown-item" href="index.html"><i class="align-middle me-1" data-feather="settings"></i> Settings & Privacy</a>-->
<!--                                    <a class="dropdown-item" href="#"><i class="align-middle me-1" data-feather="help-circle"></i> Help Center</a>-->
<!--                                    <div class="dropdown-divider"></div>-->
<!--                                    <a class="dropdown-item" href="#">Log out</a>-->
<!--                                </div>-->
<!--                            </li>-->
<!--                        </ul>-->
<!--                    </div>-->
                </nav>

    <main class="content">
        <div class="container-fluid p-0">
            <!-- Strat Name, Asset Timeframe, Description           -->
            <h1 class="h3 mb-3"><strong>{{ current_strat_dict.strategy_name }}</strong></h1>
            <h3>For {{ asset_name }} on 1 Hour Candles from {{start_date}} to {{end_date}}</h3>
            <!-- strategy description          -->
            <div class="row">
                 <div class="col-12">
                     <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="col mt-0">
                                    <h3 class="card-title"><strong>Description</strong></h3>
                                </div>
                            </div>
                            <div class="mb-0">
                                <p>{{ current_strat_dict.strategy_description }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--  DISPLAY PERMUTATION PARAMS      -->
            <div class="row">
                 <div class="col-12">
                     <div class="card">
                         <div class="card-header">
                             <div class="row">
                                <div class="col mt-0">
                                    <h2 class="card-title"><strong>Permutation Parameters:</strong></h2>
                                </div>
                             </div>
                             <table class="table table-hover my-0">
                                  <thead>
                                    <tr>
                                        {% for k in strategy_params.keys %}
                                            <th scope="col">{{ k }}</th>
                                        {% endfor %}
                                    </tr>
                                  </thead>
                                  <tbody>
                                     <tr>
                                         {% for v in strategy_params.values %}
                                            <td>{{ v }}</td>
                                         {% endfor %}
                                     </tr>
                                  </tbody>
                             </table>
                         </div>
                    </div>
                </div>
            </div>

            <!--    DISPLAY THE TRADES CHART-->
            <div class="row">
                 <div class="col-12">
                     <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="accordion" id="trades_accordian">
                                    <div class="accordion-item">
                                        <h2 class="accordion-header" id="trades">
                                            <a class="nav-link dropdown-toggle" id="alertsDropdown" data-bs-toggle="collapse" data-bs-target="#collapsetrades" aria-expanded="true" aria-controls="collapsetrades">
                                                <span class="text-dark">Annotated Trades</span>
                                            </a>
                                            <hr>
                                        </h2>
                                        <div id="collapsetrades" class="accordion-collapse collapse show" aria-labelledby="headingtrades" data-bs-parent="#trades_accordian">
                                          <div class="accordion-body">
                                              <div class="row ">
                                                <div class="col">
                                                    {{ candle_chart|safe }}
                                                </div>
                                              </div>
                                          </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--    DISPLAY THE EQUITY CURVE CHART-->
            <div class="row">
                 <div class="col-12">
                     <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="accordion" id="equity_curve_accordian">
                                    <div class="accordion-item">
                                        <h2 class="accordion-header" id="headingCurve">
                                            <a class="nav-link dropdown-toggle" id="alertsDropdown" data-bs-toggle="collapse" data-bs-target="#collapseCurve" aria-expanded="true" aria-controls="collapseCurve">
                                                <span class="text-dark">Equity Curve</span>
                                            </a>
                                            <hr>
                                        </h2>
                                        <div id="collapseCurve" class="accordion-collapse collapse show" aria-labelledby="headingCurve" data-bs-parent="#equity_curve_accordian">
                                          <div class="accordion-body">
                                              <div class="row ">
                                                <div class="col">
                                                    {{ equity_curve_chart|safe }}
                                                </div>
                                              </div>
                                          </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--    DISPLAY MAE/MFE CHARTS-->
            <div class="row">
                 <div class="col-12">
                     <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="accordion" id="outer_accordian">
                                    <div class="accordion-item">
                                            <h2 class="accordion-header" id="headingOuter">
                                                <a class="nav-link dropdown-toggle" id="alertsDropdown" data-bs-toggle="collapse" data-bs-target="#collapseOuter" aria-expanded="false" aria-controls="collapseOuter">
                                                    <span class="text-dark">Trade MAE/MFE Data</span>
                                                </a>
                                                <hr>
                                            </h2>
                                            <div id="collapseOuter" class="accordion-collapse collapse show" aria-labelledby="headingOuter" data-bs-parent="#outer_accordian">
                                              <div class="accordion-body">
                                                  <div class="row ">

                                                       <div class="accordion" id="inner_accordian">

                                                            <!-- winners MFE    -->
                                                            <div class="accordion-item">
                                                                <h3 class="accordion-header" id="headingOne">
                                                                   <a class="nav-link dropdown-toggle" id="alertsDropdown" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                                                                       <span class="text-dark">Winners MFE</span>
                                                                   </a>
                                                                   <hr>
                                                                </h3>
                                                                <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#inner_accordian">
                                                                  <div class="accordion-body">
                                                                      <div class="row ">
                                                                        <div class="col">
                                                                            {{ excursion_charts.winners_MFE_chart|safe }}
                                                                        </div>
                                                                      </div>
                                                                  </div>
                                                                </div>
                                                            </div>

                                                            <!-- winners MAE    -->
                                                            <div class="accordion-item">
                                                                <h3 class="accordion-header" id="headingTwo">
                                                                    <a class="nav-link dropdown-toggle" id="alertsDropdown" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                                                       <span class="text-dark">Winners MAE</span>
                                                                    </a>
                                                                    <hr>
                                                                </h3>
                                                                <div id="collapseTwo" class="accordion-collapse collapse show" aria-labelledby="headingTwo" data-bs-parent="#inner_accordian">
                                                                  <div class="accordion-body">
                                                                      <div class="row ">
                                                                        <div class="col">
                                                                            {{ excursion_charts.winners_MAE_chart|safe }}
                                                                        </div>
                                                                    </div>
                                                                  </div>
                                                                </div>
                                                            </div>

                                                            <!-- losers MFE   -->
                                                            <div class="accordion-item">
                                                                <h3 class="accordion-header" id="headingThree">
                                                                    <a class="nav-link dropdown-toggle" id="alertsDropdown" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                                                       <span class="text-dark">Losers MFE</span>
                                                                    </a>
                                                                    <hr>
                                                                </h3>
                                                                <div id="collapseThree" class="accordion-collapse collapse show" aria-labelledby="headingThree" data-bs-parent="#inner_accordian">
                                                                  <div class="accordion-body">
                                                                      <div class="row ">
                                                                        <div class="col">
                                                                            {{ excursion_charts.losers_MFE_chart|safe }}
                                                                        </div>
                                                                    </div>
                                                                  </div>
                                                                </div>
                                                            </div>

                                                            <!-- losers MAE   -->
                                                            <div class="accordion-item">
                                                                <h3 class="accordion-header" id="headingFour">
                                                                    <a class="nav-link dropdown-toggle" id="alertsDropdown" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                                                                       <span class="text-dark">Losers MAE</span>
                                                                    </a>
                                                                    <hr>
                                                                </h3>
                                                                <div id="collapseFour" class="accordion-collapse collapse show" aria-labelledby="headingFour" data-bs-parent="#accordionExample">
                                                                  <div class="accordion-body">
                                                                      <div class="row ">
                                                                        <div class="col">
                                                                            {{ excursion_charts.losers_MAE_chart|safe }}
                                                                        </div>
                                                                    </div>
                                                                  </div>
                                                                </div>
                                                            </div>

                                                        </div>

                                                  </div>
                                              </div>
                                            </div>
                                        </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Eval Metrics and Trades Data           -->
            <div class="row">
						<div class="col-12 col-xxl-3 d-flex">
							<div class="card flex-fill">
								<div class="card-header">

									<h5 class="card-title mb-0"><strong>Evaluation Metrics</strong></h5>
								</div>
                                <table class="table table-hover my-0">
                                    <thead></thead>
                                     <tbody>
                                      {% for k,v in evaluation_metrics.items %}
                                         <tr>
                                             <td>{{ k }}</td>
                                             <td>{{ v }}</td>
                                         </tr>
                                     {% endfor %}
                                     </tbody>
                                </table>
							</div>
						</div>
						<div class="col-12 col-xxl-9 d-flex TradeDataScroll">
							<div class="card flex-fill">
								<div class="card-header">
									<h5 class="card-title mb-0"><strong>Trades Data</strong></h5>
								</div>
								<div style="height:1200px; overflow-y: scroll;" class="card-body d-flex">
									<table class="table table-hover">
                                      <thead>
                                        <tr>
                                            {% for hdr in trades_list_titles %}
                                                <th scope="col">{{ hdr }}</th>
                                            {% endfor %}
                                        </tr>
                                      </thead>
                                      <tbody>
                                         {% for trade in trades_list %}
                                             <tr>
                                                 <td>{{ trade.trade_num }}</td>
                                                 <td>{{ trade.bias }}</td>
                                                 <td>{{ trade.entry_price }}</td>
                                                 <td>{{ trade.risk_price }}</td>
                                                 <td>{{ trade.exit_price }}</td>
                                                 <td>{{ trade.entry_datetime }}</td>
                                                 <td>{{ trade.exit_datetime }}</td>
                                                 <td>{{ trade.R_realized }}</td>
                                                 <td>{{ trade.running_total_R }}</td>
                                             </tr>
                                         {% endfor %}

                                      </tbody>
                                     </table>
								</div>
							</div>
						</div>
					</div>


        </div>
    </main>

    <footer class="footer">
        <div class="container-fluid">
            <div class="row text-muted">
                <div class="col-6 text-start">
<!--                    <p class="mb-0">-->
<!--                        <a class="text-muted" href="https://adminkit.io/" target="_blank"><strong>AdminKit</strong></a> &copy;-->
<!--                    </p>-->
                </div>
                <div class="col-6 text-end">
<!--                    <ul class="list-inline">-->
<!--                        <li class="list-inline-item">-->
<!--                            <a class="text-muted" href="https://adminkit.io/" target="_blank">Support</a>-->
<!--                        </li>-->
<!--                        <li class="list-inline-item">-->
<!--                            <a class="text-muted" href="https://adminkit.io/" target="_blank">Help Center</a>-->
<!--                        </li>-->
<!--                        <li class="list-inline-item">-->
<!--                            <a class="text-muted" href="https://adminkit.io/" target="_blank">Privacy</a>-->
<!--                        </li>-->
<!--                        <li class="list-inline-item">-->
<!--                            <a class="text-muted" href="https://adminkit.io/" target="_blank">Terms</a>-->
<!--                        </li>-->
<!--                    </ul>-->
                </div>
            </div>
        </div>
    </footer>
</div>

{% endblock content %}